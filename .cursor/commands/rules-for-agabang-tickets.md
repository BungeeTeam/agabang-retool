# rules-for-agabang-tickets
# 아가방 유지보수 프로젝트 관련 rule
## 아가방 유지보수 프로젝트 맥락
개발은 끝났고, 지금은 아가방앤컴퍼니에서 이용하며 발생하는 아래 종류의 문의에 대한 대응만 하고 있음.
- 오류 제보 발생시 그에 대한 수정 대응
- 사용방법 미숙지로 인해 질문하는 경우 사용 방법 안내
- (임시) 기능 개선 요청에 대한 대응
대응은 티켓 처리 기준에 따라 대응하고 있음
### 이해관계자
- 클리브: 아가방앤컴퍼니 실무자가 업무에 사용하는 소프트웨어(웹으로 사용)를 구축하였고, 개발 완료 후 발생하는 문의에 대해 대응중.
- 아가방앤컴퍼니: 클리브가 구축한 소프트웨어를 사용하는 고객. 문의를 남기는 사람.

## 티켓 처리 프로세스
1. 티켓의 내용을 이해한다.
	1. retooldb mcp를 사용해서 retool_app 데이터 베이스의 user_reports 테이블의 내용을 본다.
	2. retooldb mcp를 사용해서 retool_app 데이터 베이스의 replies 테이블의 내용을 참고하여 과거 유사 사례에 대한 대응을 필요에따라 보조적으로 사용한다.
2. 문의 내용에 따라 처리 프로세스를 따른다.
#### 오류 및 버그 제보일시
1. 요청한 티켓 내용과 유관한 사용자 로그를 찾는다.
	1. retooldb mcp를 사용해서 retool_system 데이터베이스의 audit_trail_events 테이블에서 유저정보, app_name이 일치하면서 티켓이 생성된 시간으로부터 30분 전 사이의 로그를 확인한다.
		1. 유저 정보는 users테이블을 참고한다.
	2. 티켓 내용과 유관한 로그가 30분 시간 범위 내에서 발견되지 않는다면, 시간 범위를 5분 간격으로 늘려서 확인한다.
2. 유관한 사용자 로그에 기반하여 버그를 재현한다.
	1. agabang-retool 리포지토리의 앱 코드를 참고한다.
	2. sql을 실제로 실행해봐야할 경우 mcp-clickhouse와 retooldb mcp를 사용하여 실행한다.
	3. 웹 브라우저에서의 작동을 확인해봐야할 경우 playwright를 사용하여 테스트 한다.
3. 원인이 파악된 경우 이것이 진짜 오류인 것인지, 아니면 사용자의 사용방법 미숙인 것인지 판단단다.
4. 오류라면 클리브 직원이 읽을 디버깅 리포트를 작성한다. 하지만 오류가 아니라면 고객에게 오류가 아니며 정상적인 작동이라는 것을 알리는 메세지를 작성한다.
#### 사용 방법 질문에 해당할 시
1. 과거 유사한 질문과 그에 대한 답변이 있는지 확인한다.
	1. retooldb mcp를 활용한다.
2. 유사한 답변이 없으면 agabang-retool 리포지토리의 앱 코드를 참고하여 고객 전송용 답변을 작성한다.

#### 기능 개선 요청일 시
1. 과거 유사한 질문과 그에 대한 답변이 있는지 확인한다.
	1. retooldb mcp를 활용한다.
2. 유사한 답변이 있으면 그 답변과 티켓 처리 기준에 따라 티켓을 수용할지 말지 결정한다.
3. 결정한 내용을 근거와 함께 고객전송용 메세지를 작성한다.

## retooldb mcp 사용시 주의사항
set_database를 통해 필요한 데이터가 저장되어 있는 적절한 데이터베이스를 선택합니다. 
- retool_system
   - 정의: Retool의 system DB로서 유저 정보, 쿼리 등 Retool 내부 데이터가 저장되어 있음
   - use case
	   - audit log 추출
		   - audit_trail_events 테이블에서 티켓과 관련된 로그를 추출한다. 
		   - 유저 정보, app_name가 일치하면서
		   - 티켓이 생성된 시간으로부터 30분 전
			   - 30분 안에 제보한 내용과 관련된 로그가 없다면 5분 단위로 탐색 범위 늘림
		   - 유저 정보는 users테이블을 userID기반으로 조인하여 확인
- retool_app
	- 정의: Retool application DB로서, Retool로 구축한 application에서 사용하고 있는 데이터가 저장되어 있음
	- use case
		- 티켓 내용 확인
			- user_reports 테이블을 보면 됨
				- user_reports는 고객이 직접 작성하는 문의 티켓이 저장되는 테이블임
		- 각 문의 티켓에 매칭되는 답변들 확인
			- replies 테이블을 보면 됨
				- replies는 각 티켓에 매칭되는 답변들이 작성되는 테이블임
				- 이 테이블에 작성되는 contents들은 

## 티켓 처리 기준 문서
### 티켓 처리의 목적
- 데이터 정합성 확보
### 우선 순위: 티켓 처리 목적에 따라 리소스 분배를 적절히 하기 위해 세워진 기준
- 즉시 처리 (최우선) : 명백한 데이터 오류
	- 기존에 제공되고 있는 데이터(매출, 수량 등)가 실제와 다르게 표시되는 경우
	- 표시되어야 할 데이터가 나오지 않는 경우
	- 계산 로직 오류로 인한 잘못된 결과값 
- 후순위 처리 : 기능 개선 및 사용성 향상
	- 화면 레이아웃 조정 (컬럼 순서, 색상 등)
	- 데이터 표시 방식 개선 (단위, 명칭 변경 등) 
	- ※ 현재 우선순위 작업을 먼저 완료한 후 순차적으로 검토하여 반영해드리겠습니다.
- 유지보수 범위 외 사항으로 반영 어려운 영역
	- 구조적 변경 및 신규 데이터 조회
		- 기존 범위를 벗어난 새로운 데이터 추가 
		- 개발 단계에서 확정된 시스템 구조 및 로직 변경
		- 새로운 분석 기능 및 리포트 추가 
		- 기존 기능으로 해결 가능한 경우, 대안 사용법을 우선 안내해드리겠습니다.
		- 신규 데이터 조회가 필요한 경우 추가 계약 검토가 필요합니다. 

## 답변 메세지 작성 가이드라인
### 답변 메세지 작성 이유:
- 티켓 접수 및 처리하는 과정에 대하여 티켓 게시자에게 정보를 제공하기 위함
### 메세지 작성 가이드라인
1. 메세지 기본 구조: Format에 맞추어 메세지 작성
	Format
```
[말머리]
인삿말
고객 문의 내용 간략히 요약

메인 메세지

감사합니다!
``` 
2. 말머리 선택 기준
	1. 말머리는 메세지 내용에 따라 [처리 완료 안내], [반려 처리 안내], [보류 처리 안내], [진행 상황 공유], [추가 답변 요청] 중 하나 골라서 쓸 것.
	2. [처리 완료 안내]: 티켓에서 문의한 내용 해결 완료 시
	3. [반려 처리 안내]: 티켓에서 문의한 내용을 처리할 수 없을 때
	4. [보류 처리 안내]: 필요한 추가 답변을 받지 못해 처리가 불가능하여 팬딩처리 되었을 때
	5. [추가 답변 요청]: 티켓을 처리하기 위해 추가적인 답변이 필요할 때
	6. [진행 상황 공유]: 티켓 처리의 중간 상황을 공유할 때
3. 작성 원칙
	1. 말투 및 톤
		1. 친근한 비즈니스 말투 사용하여 과도하게 격식적이지는 않으나 전문적인 말투
		2. 자연스러운 한국어 표현 사용
	2. 형식 및 스타일
		1. 이모지 사용 절대 금지. 친근함은 말투로 표현할 것.
		2. 불릿과 볼드체 등 서식 사용 금지
			1. 불릿만 필요한 경우에 한하여 최소한으로 사용
		3. 과도하고 과장된 강조 표시 지양
	3. 어휘 선택
		1. IT 회사에서 주로 사용하는 용어 사용 지양
		2. 기술적인 내용에 해당하는 것은 생략하거나 기술 지식이 전혀 없는 사람도 이해할 수 있을 정도의 간단한 용어로 변경
4. 메인 메세지 작성 시 유의사항
	1. 내용 전달
		1. 인풋으로 받은 기술적인 내용 혹은 전달하고자 하는 핵심 내용을 고객용으로 워싱하여 부드럽게 재작성
		2. 인풋으로 받은 것을 활자 그대로 옮겨적지 말 것.
		3. 기술적인 세부사항보다는 문제의 원인과, 영향, 결과에 초점
	2. 문제 설명 방식
		1. 해결 완료 사실에 집중
		2. 문제의 원인은 기술적인 부분보다는 고객이 체감할 수 있는 부분에 제한하여 설명
	3. 범위 외, 혹은 제한적 수용 티켓에 대한 처리
		1. 유지보수 범위 외의 사항임을 명확하게 할 것
		2. 거절보다는 안내의 톤
		3. 가능한 경우 대안 제시
5. 고객 문의 요약 작성 원칙
	1. 고객이 작성한 티켓의 내용을 가능한 한 문장 이내로 간결하게 정리
	2. 고객의 문의보다는 
6. 추가 작성 원칙
	1. 추가 계약/비용 이야기는 최소화
		- "추가 계약 검토가 필요합니다" → 너무 직접적
		- "현재 유지보수 범위에서는 반영이 어려운 부분입니다" → 적절
		- 대안이 없는 경우 대안 제시 멘트도 생략
	2. 제한적 수용 처리 시 설명 방식
		1.  "우선적으로", "먼저", "예외적으로" 같은 표현으로 특별 배려 강조 지양
	3. IT 용어 → 일반 비즈니스 용어 변환
		1. 티켓 → 문의사항, 요청사항
		2. 펜딩 → 확인 중, 검토 중
		3. 얼라인 → 의견 조율, 기준 맞춤, 이해의 차이
		4. 레이블링 → 표시 방식, 명칭
	4. 메세지 끝맺음 문장 작성시 불필요한 열린 질문 지양
		1. "추가적인 도움 필요하시면" → 어색하고 추가 요청 유도 가능성
		2. "편하게 의견 주세요" → 범위 외 요청도 가능하다는 오해 유발
		3. "궁금하신 점 있으시면 말씀해주세요" → 적절
